syntax = "proto3";
package file_transfer;

service FileTransfer {
  // Stream all pieces for requested shards
  rpc StreamShards(ShardRequest) returns (stream PieceData);
}

message ShardRequest {
  string job_id = 1;
  int32 from_shard = 2;    // Start from this shard
  int32 from_piece = 3;    // Start from this piece within the shard
}

message PieceData {
  int32 shard_id = 1;
  int32 piece_index = 2;
  int32 total_pieces = 3;  // Total pieces in this shard
  bytes data = 4;
  fixed32 crc32c = 5;      // Transfer integrity check
}
